# Надбавки за высоту 2301–2500 и 2501–3000 мм

На UI в разделе «РАЗМЕРЫ» высоты отображаются интервалами: **2301–2500** и **2501–3000**. Отдельных товаров в БД для этих высот нет; цена считается как **цена той же двери с высотой 2000 мм + надбавка в %**.

---

## Где хранятся проценты

- **В БД:** в `properties_data` товара (Product), как правило у продукта с **Высота/мм = 2000** той же модели (модель, покрытие, цвет, ширина совпадают).
- **Ключи в properties_data (канонические):**
  - `Domeo_Опции_Надбавка_2301_2500_процент` — надбавка в % для интервала 2301–2500 мм к цене двери 2000 мм.
  - `Domeo_Опции_Надбавка_2501_3000_процент` — надбавка в % для интервала 2501–3000 мм к цене двери 2000 мм.

Движок цены (`lib/price/doors-price-engine.ts`) при выборе высоты 2350 или 2750 маппит её в 2000 для поиска товара, берёт у найденного товара Цена РРЦ и эти два процента, считает надбавку от базы и добавляет в breakdown. Итоговая цена двери округляется **вверх до 100 руб** (`roundUpTo100`).

---

## Импорт / Excel

- **Скрипт import-final-filled:** колонки в Excel — `Надбавка 2301-2500мм (%) к высоте 2000` и `Надбавка 2501-3000мм (%) к высоте 2000` (лист с опциями модели). Значения записываются в `Domeo_Опции_Надбавка_2301_2500_процент` и `Domeo_Опции_Надбавка_2501_3000_процент`.
- **Экспорт (doors-package, smoke):** при выгрузке в Excel из БД обратно подставляются человекочитаемые заголовки `Надбавка 2301-2500мм (%) к высоте 2000` и `Надбавка 2501-3000мм (%) к высоте 2000`.
- **lib/services/doors-import.service.ts:** использует колонки `Надбавка 2301-2500мм (%)` и `Надбавка 2501-3000мм (%)` (без « к высоте 2000»); при необходимости маппинг в канонические ключи `Domeo_Опции_*` нужно делать в этом сервисе.

---

## Округление

Итоговая сумма расчёта цены двери (база + надбавки за высоту, реверс, зеркало, порог, кромка, фурнитура и т.д.) округляется **вверх до 100 руб**: `Math.ceil(total / 100) * 100`. Функция: `roundUpTo100()` в `lib/price/doors-price-engine.ts`.
